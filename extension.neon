parametersSchema:
    regexParser: structure([
        # Whether to ignore regex parsing errors (e.g., missing delimiters)
        ignoreParseErrors: bool(),
        # Enable/disable ReDoS vulnerability detection
        reportRedos: bool(),
        # Minimum severity level to report: 'low', 'medium', 'high', 'critical'
        redosThreshold: string(),
        # Enable/disable regex optimization suggestions
        suggestOptimizations: bool()
    ])

parameters:
    regexParser:
        # Ignore parsing errors like missing delimiters (common in dynamic regex)
        ignoreParseErrors: true

        # Enable comprehensive ReDoS vulnerability detection
        reportRedos: true

        # Report only high and critical severity ReDoS issues
        # Options: 'low' (most sensitive), 'medium', 'high', 'critical' (least sensitive)
        redosThreshold: 'high'

        # Enable regex optimization suggestions
        suggestOptimizations: false

services:
    # Main regex validation rule for PHPStan
    -
        class: RegexParser\Bridge\PHPStan\PregValidationRule
        arguments:
            ignoreParseErrors: %regexParser.ignoreParseErrors%
            reportRedos: %regexParser.reportRedos%
            redosThreshold: %regexParser.redosThreshold%
            suggestOptimizations: %regexParser.suggestOptimizations%
        tags:
            - phpstan.rules.rule
